-# coding: utf-8
-content_for :include do
  =stylesheet_link_tag 'tablesorter/style'
  =javascript_include_tag 'jquery.tablesorter.min', 'uitablefilter'
.row.wide
  .col-md-12
    .hero-unit
      %h1.title
        =mt('Filters')
    .inner
      %table.table.tablesorter#sortme
        %thead
          %tr
            %th.first=mat(:filter, :uid)
            %th=mat(:filter, :name)
            %th=mat(:filter, :created_by)
            %th.last
              %form#filter-form
                %input#filter{:name=>"filter",:value=>"",:maxlength=>"30",:size=>"30",:type=>"text",:placeholder=>'Filter'}/
        %tbody
          -@filters.each do |filter|
            %tr
              %td.first=filter.uid
              %td=filter.name
              %td=filter.account.name
              %td.last
                =link_to pat('Edit'), url(:editfilter, :uid => filter.uid), :method => :get
                |
                =link_to pat('View'), url(:embed_filter, :uid => filter.uid), :method => :get

      -unless current_account.nil?
        -if ["admin","editor"].include? current_account.role
          :javascript
            $(document).ready(function(){
              $('#sortme').tablesorter({
                headers: { 
                  6: { sorter: false } 
                } 
              });
              var theTable = $('table#sortme')
              $("#filter").click(function(){$('#filter').focus();});
              $("#filter").keyup(function() {
                $.uiTableFilter( theTable, this.value );
              })
              $('#filter-form').submit(function(){
                return false;
              }).focus(); 
            });
        -else
          :javascript
            $(document).ready(function(){
              $('#sortme').tablesorter({
                headers: { 
                  6: { sorter: false }
                } 
              });
              var theTable = $('table#sortme')
              $("#filter").click(function(){$('#filter').focus();});
              $("#filter").keyup(function() {
                $.uiTableFilter( theTable, this.value );
              })
              $('#filter-form').submit(function(){
                return false;
              }).focus(); 
            });
