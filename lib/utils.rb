#coding:utf-8
def create_accounts

  ppl = [{:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>101}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>78}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>79}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>99}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>103}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>100}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>102}, {:name=>"Esra Başak", :email=>"esra.basak.ist@gmail.com", :organization=>"", :address=>"Emirhan Caddesi\r\nSaraka Sokak Yediemekçi Apt. 2/2\r\nDikilitaş- Beşiktaş", :phone=>nil, :version_id=>16}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>80}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>81}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>82}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>83}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>84}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>85}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>86}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>87}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>88}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>89}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>90}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>91}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>92}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>93}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>94}, {:name=>"Arca Atay", :email=>"arcaatay@gmail.com", :organization=>"EKODER Ekolojik Yaşam Derneği", :address=>"Demirsubaşı Mah.Gazino Sok. No.22/2, 16600, Gemlik-Bursa", :phone=>"0532 427 01 28", :version_id=>104}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>97}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>95}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>98}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>96}, {:name=>"Arca Atay", :email=>"arcaatay@gmail.com", :organization=>"EKODER Ekolojik Yaşam Derneği", :address=>"Demirsubaşı Mah.Gazino Sok. No.22/2, 16600, Gemlik-Bursa", :phone=>"0532 427 01 28", :version_id=>105}, {:name=>"Ahmet Yaraş", :email=>"ahmetyaras@hotmail.com", :organization=>"Allianoi Girişim Grubu ", :address=>"", :phone=>nil, :version_id=>6}, {:name=>"", :email=>"", :organization=>"", :address=>"Köknar Köyü & Karaçam", :phone=>"", :version_id=>109}, {:name=>"Ümit Şahin", :email=>"umitsa2005@gmail.com", :organization=>"Yeşiller Partisi", :address=>"", :phone=>nil, :version_id=>54}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>nil, :version_id=>59}, {:name=>"Bahadır Doğutürk", :email=>"bdoguturk@hotmail.com", :organization=>"FOÇEP", :address=>"", :phone=>nil, :version_id=>4}, {:name=>"Ceren Soylu", :email=>"soylu.ceren@yahoo.com", :organization=>"University of Massachusetts, Amherst", :address=>"University of Massachusetts, Amherst\r\nDepartment of Economics, Thompson Hall, 1014\r\nAmherst, MA\r\nUSA", :phone=>nil, :version_id=>18}, {:name=>"Bengi Akbulut", :email=>"bengi.akbulut@gmail.com", :organization=>"", :address=>"", :phone=>nil, :version_id=>11}, {:name=>"Murat Uralkan", :email=>"mu62@cornell.edu", :organization=>"Cornell University", :address=>"", :phone=>nil, :version_id=>8}, {:name=>"Nuri Özbağdatlı", :email=>"nuriozbagdatli@gmail.com", :organization=>"UNDP Türkiye", :address=>"", :phone=>nil, :version_id=>40}, {:name=>"Mahmut Boynudelik", :email=>"mahmut@adatepe.com", :organization=>"Taksim Platformu, Yeşiller Partisi", :address=>"", :phone=>nil, :version_id=>13}, {:name=>"Ekin Kurtiç", :email=>"ekinkurtic@gmail.com", :organization=>"Boğaziçi Üniversitesi", :address=>"Boğaziçi Üniversitesi\r\nSiyaset Bilimi ve Uluslar arası İlişkiler Bölümü\r\n34342 Bebek İstanbul", :phone=>nil, :version_id=>14}, {:name=>"Cem İskender Aydın", :email=>"", :organization=>"Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>17}, {:name=>"Muammer Sakaryalı", :email=>"mu.sakaryali@gmail.com", :organization=>"İnay Köyü Vicdan Hareketi veya Kışladağ Vicdan Hareketi ", :address=>"180 sok No: 13 Küçükyalı – İZMİR", :phone=>nil, :version_id=>20}, {:name=>"Prof. Dr. Mustafa Sarı", :email=>"msari@yyu.edu.tr", :organization=>"Yüzüncü Yıl Üniversitesi Su Ürünleri Fakültesi, Doğa Gözcüleri Derneği", :address=>"Yüzüncü Yıl Üniversitesi Su Ürünleri Fakültesi\r\n65080 Van, Türkiye\r\n", :phone=>nil, :version_id=>21}, {:name=>"Irmak Ertör, Pınar Ertör Akyazı", :email=>"", :organization=>"Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>23}, {:name=>"Kemal Bayrı", :email=>"kemalbayri@hotmail.com", :organization=>"Yalova Çevre Platformu", :address=>"Adnan Menderes Mahallesi TOKİ Evleri 8.sokak 7/1 Yalova", :phone=>nil, :version_id=>24}, {:name=>"Serkan Kaptan", :email=>"serkanyak@gmail.com", :organization=>"", :address=>"", :phone=>nil, :version_id=>25}, {:name=>"Okan Ürker", :email=>"okan.urker@gmail.com", :organization=>"Bozkır Çevre Derneği-KIRŞEHİR (Eski Yönetim Kurulu Başkanı)", :address=>"Eryaman 1.Etap Aktürk Sitesi Sümbül Sok. Akçay Apt. 58/3 ANKARA", :phone=>nil, :version_id=>27}, {:name=>"Ayşen Eren", :email=>"ayseneren@yahoo.com", :organization=>"", :address=>"", :phone=>nil, :version_id=>32}, {:name=>"Bahattin Sürücü", :email=>"info@ekodosd.org", :organization=>"Ekosistemi Koruma ve Doğa Sevenler Derneği", :address=>"Atatürk Bulvarı Konuk İş Merkezi 40/12 Kuşadası/AYDIN", :phone=>nil, :version_id=>56}, {:name=>"Serkan Kaptan", :email=>"serkanyak@gmail.com", :organization=>"Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>33}, {:name=>"Hakan Dedeoğlu", :email=>"h.hakandedeoglu@mynet.com", :organization=>"TEMA Vakfı Lüleburgaz Gönüllü Sorumlusu (Ergene Platformu)", :address=>"İstanbul Caddesi Mercan Çarşısı No: 55 Lüleburgaz - Kırklareli", :phone=>nil, :version_id=>34}, {:name=>"Ekin Kurtiç", :email=>"ekinkurtic@gmail.com", :organization=>"Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>35}, {:name=>"Akgün İlhan ve Ali Kerem Saysel", :email=>"ali.saysel@gmail.com", :organization=>"Hasankeyf’i Yaşatma Girişimi / Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>39}, {:name=>"Mahir Ilgaz", :email=>"mahirilgaz@gmail.com", :organization=>"Marmara Üniversitesi", :address=>"", :phone=>nil, :version_id=>44}, {:name=>"Umut Kocagöz", :email=>"ukocagoz@hotmail.com", :organization=>"", :address=>"", :phone=>nil, :version_id=>45}, {:name=>"Duygu Avcı, Alper Akyüz, Begüm Özkaynak", :email=>"", :organization=>"ISS, Bilgi Üniversitesi, Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>50}, {:name=>"Zeynep Kadirbeyoğlu", :email=>"kadirbeyoglu@gmail.com", :organization=>"Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>43}, {:name=>"Hakan Dedeoğlu", :email=>"h.hakandedeoglu@mynet.com", :organization=>"TEMA Vakfı Lüleburgaz Gönüllü Sorumlusu (Ergene Platformu)", :address=>"", :phone=>nil, :version_id=>42}, {:name=>"Mine Işlar", :email=>"mine.islar@lucsus.lu.se", :organization=>"Lund Universitesi", :address=>"Geocentrum I, Sölvegatan 10, LUCSUS\r\nLund- Sweden", :phone=>nil, :version_id=>46}, {:name=>"Okan Can", :email=>"okan.can71@gmail.com", :organization=>"Yerel İnisiyatif", :address=>"No:201 Limanköy \r\nDemirköy/Kırklareli", :phone=>nil, :version_id=>47}, {:name=>"Okan ÜRKER ", :email=>"okan.urker@gmail.com", :organization=>"Doğa Koruma Merkezi", :address=>"", :phone=>nil, :version_id=>48}, {:name=>"Bahadır Doğutürk", :email=>"bdoguturk@hotmail.com", :organization=>"FOÇEP", :address=>"", :phone=>nil, :version_id=>51}, {:name=>"Hande Paker ve Akgun İlhan", :email=>"hande.paker@bahcesehir.edu.tr", :organization=>"Bahçeşehir Üniversitesi ve Su Hakkı Kampanyası", :address=>"", :phone=>nil, :version_id=>52}, {:name=>"Oğuz Kurdoğlu", :email=>"oguzkurdoglu@gmail.com", :organization=>"Karadeniz Teknik Üniversitesi", :address=>"KTÜ Orman Fak. Orman Müh. Bölümü Trabzon", :phone=>nil, :version_id=>55}, {:name=>"Neşet Kutluğ", :email=>"", :organization=>"Kuzguncuklular Derneği", :address=>"Kuzguncuklular Derneği\r\nİcadiye Cad. 44/A Kuzguncuk Üsküdar ", :phone=>nil, :version_id=>19}, {:name=>"Mustafa Şenbahar", :email=>"mustafa.senbahar@hotmail.com", :organization=>"", :address=>"Yayla Köyü Karaburun İzmir ", :phone=>nil, :version_id=>7}, {:name=>"Zeynep Kadirbeyoğlu ve Murat Arsel", :email=>"", :organization=>"Boğaziçi Üniversitesi ve ISS", :address=>"", :phone=>nil, :version_id=>57}, {:name=>"Serkan Kaptan", :email=>"", :organization=>"Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>15}, {:name=>"Orhan GÜL", :email=>"orhan_gul@yahoo.com", :organization=>"Ege Üniversitesi", :address=>"Ege Üniversitesi, Tabiat Tarihi Uygulama ve Araştırma Merkezi,\r\n35100, Bornova, İzmir - TÜRKİYE", :phone=>nil, :version_id=>22}, {:name=>"Irmak Ertör", :email=>"", :organization=>"Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>26}, {:name=>"Özgül Erdemli Mutlu", :email=>"ozgul.erdemli@tema.org.tr", :organization=>"TEMA Vakfı", :address=>"TEMA Vakfı\r\nÇayır Çimen Sok. Emlak Kredi Blokları\r\nA-2 Blok, Levent, Istanbul", :phone=>nil, :version_id=>31}, {:name=>"Ayşe Sargın", :email=>"ayse.sargin@dogadernegi.org", :organization=>"Doğa Derneği", :address=>"", :phone=>nil, :version_id=>58}, {:name=>"Ayşen Eren, Cem İskender Aydın", :email=>"", :organization=>"Boğaziçi Üniversitesi", :address=>"", :phone=>nil, :version_id=>49}, {:name=>"Mehmet Tunçer", :email=>"mehmettuncer56@gmail.com", :organization=>"Abant İzzet Baysal Üniversitesi", :address=>"Abant İzzet Baysal Üniversitesi, Mühendislik-Mimarlık Fakültesi, Mimarlık Bölümü\r\nGölköy Kampusü 14280 – Bolu\r\nTel : + 90 374 387 10 00 / 2646\r\nFax: + 90 374 634 45 58 \r\nmobile: + 90 533 441 01 04 ", :phone=>nil, :version_id=>53}, {:name=>"Barış Gençer Baykan ve Cem İskender Aydın", :email=>"baris.baykan@bahcesehir.edu.tr", :organization=>"Bahçeşehir Üniversitesi ve Boğaziçi Üniversitesi", :address=>"", :phone=>"", :version_id=>38}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>60}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>61}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>62}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>63}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>64}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>65}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>66}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>67}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>68}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>69}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>70}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>71}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>72}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>73}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>74}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>75}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>76}, {:name=>"", :email=>"", :organization=>"", :address=>"", :phone=>"", :version_id=>77}, {:name=>"Lale Aktay", :email=>"lale.aktay@gmail.com", :organization=>"KuzeyDoga Dernegi", :address=>"KuzeyDoga Dernegi \r\nOrtakapi Mah. Sehit Yusuf Cad. No:93 Kat:1\r\nMerkez\r\nKars\r\n36100\r\nTurkey", :phone=>"0535 465 0765", :version_id=>106}, {:name=>"Lale Aktay", :email=>"lale.aktay@gmail.com", :organization=>"KuzeyDoga Dernegi", :address=>"KuzeyDoga Dernegi \r\nOrtakapi Mah. Sehit Yusuf Cad. No:93 Kat:1\r\nMerkez\r\nKars\r\n36100\r\nTurkey", :phone=>"0535 465 0765", :version_id=>108}, {:name=>"Lale Aktay", :email=>"lale.aktay@gmail.com", :organization=>"KuzeyDoga Dernegi", :address=>"KuzeyDoga Dernegi \r\nOrtakapi Mah. Sehit Yusuf Cad. No:93 Kat:1\r\nMerkez\r\nKars\r\n36100\r\nTurkey", :phone=>"0535 465 0765", :version_id=>107}] 

  edi = Account.find 1
  ppl.each do |p|
    v = Version.find(p[:version_id])
    if p[:email] == '' or p[:email].nil?
      edi.versions << v
    else
      acc = Account.find_by_email p[:email]
      if acc
        acc.versions << v
      else
        acc = Account.new
        nma = p[:name].split(' ')
        acc.name = nma[0..-2].join(' ')
        acc.surname = nma[-1]
        acc.email = p[:email]
        acc.organization = p[:organization]
        acc.address = p[:address]
        acc.phone = p[:phone]
        acc.role = 'user'
        acc.password = 'direncevre'
        acc.password_confirmation = 'direncevre'
        acc.save!
        puts acc.id.to_s+ ' ' + acc.email
        acc.versions << v
      end
    end
  end
end


def rescue_refs
  [Weblink,Medialink,Reference,Legislation].each do |model|
    losts = model.where(:locale=>nil)
    losts.each_with_index do |lost,index|
      print "\r#{model.to_s.green} #{index} / #{losts.length}"
      lost.update :locale=>lost.conflict.conflict_texts.order(:id).first.locale
    end
    puts
  end
end

def fix_refs
  [Weblink,Medialink,Reference,Legislation].each do |model|
    losts = model.where(:pid=>nil)
    del = []
    puts "#{model}: #{losts.length}"
    losts.each_with_index do |lost,index|
      print("\r#{index+1}/#{losts.length}")
      if model.where(:conflict_id=>lost.conflict_id,:url=>lost.url,:description=>lost.description).count > 1
        del << lost.id
      end
    end
    model.find(del).each &:destroy
    puts "\r#{model} cleaned: #{model.where(:pid=>nil).length} left"
    puts
    Conflict.each &:order_refs
  end
end
